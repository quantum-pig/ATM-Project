# Windows CMD乱码问题解决指南

## 🔍 问题描述

在Windows CMD中运行批处理脚本时出现乱码，通常表现为中文字符显示为问号或方块。

## 🛠️ 解决方案

### 方案1: 使用PowerShell (推荐)

PowerShell对UTF-8编码支持更好，建议使用PowerShell脚本：

```powershell
# 运行PowerShell版本
.\build_windows.ps1
.\run_windows.ps1
```

### 方案2: 修复CMD编码

#### 2.1 设置代码页
```cmd
# 在CMD中运行
chcp 65001
```

#### 2.2 修改CMD属性
1. 右键CMD标题栏 → 属性
2. 字体 → 选择"新宋体"或"微软雅黑"
3. 确定保存

#### 2.3 使用编码修复脚本
```cmd
# 运行编码修复脚本
fix_encoding.bat
```

### 方案3: 使用UTF-8 BOM

在批处理文件开头添加UTF-8 BOM标记：

```cmd
@echo off
REM 设置代码页为UTF-8
chcp 65001 >nul
```

## 📋 详细步骤

### 步骤1: 检查当前编码
```cmd
# 查看当前代码页
chcp
```

### 步骤2: 设置正确编码
```cmd
# 设置为UTF-8
chcp 65001

# 或设置为GBK (如果UTF-8不工作)
chcp 936
```

### 步骤3: 修改CMD字体
1. 打开CMD
2. 右键标题栏 → 属性
3. 字体选项卡 → 选择支持中文的字体
4. 确定保存

### 步骤4: 设置环境变量
```cmd
set PYTHONIOENCODING=utf-8
set LANG=zh_CN.UTF-8
```

## 🔧 技术原理

### 编码问题原因
1. **CMD默认编码**: Windows CMD默认使用GBK编码
2. **文件编码**: 批处理文件可能是UTF-8编码
3. **字体支持**: CMD字体可能不支持某些字符

### 解决方案对比

| 方案 | 优点 | 缺点 | 推荐度 |
|------|------|------|--------|
| PowerShell | 完美支持UTF-8 | 需要PowerShell | ⭐⭐⭐⭐⭐ |
| 修复CMD | 使用原生CMD | 设置复杂 | ⭐⭐⭐ |
| 转换编码 | 简单直接 | 可能丢失字符 | ⭐⭐ |

## 🎯 最佳实践

### 1. 使用PowerShell脚本
```powershell
# 推荐使用PowerShell版本
.\build_windows.ps1
.\run_windows.ps1
```

### 2. 如果必须使用CMD
```cmd
# 先运行编码修复
fix_encoding.bat

# 然后运行构建脚本
build_windows.bat
```

### 3. 设置系统默认编码
```cmd
# 在系统环境变量中设置
PYTHONIOENCODING=utf-8
LANG=zh_CN.UTF-8
```

## 🚨 常见错误

### 错误1: "chcp 65001" 失败
**解决方案**: 使用 `chcp 936` 或PowerShell

### 错误2: 字体显示异常
**解决方案**: 修改CMD字体为"新宋体"或"微软雅黑"

### 错误3: 环境变量不生效
**解决方案**: 重启CMD或使用PowerShell

## 📞 技术支持

如果以上方案都无法解决问题，请尝试：

1. **使用PowerShell**: 这是最可靠的解决方案
2. **检查系统语言**: 确保Windows系统语言设置正确
3. **更新Windows**: 确保系统是最新版本
4. **联系技术支持**: 提供详细的错误信息

---

**建议**: 优先使用PowerShell脚本，避免CMD编码问题！ 🎉
